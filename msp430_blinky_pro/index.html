<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MSP430 Blinky LED for Professional Edition</title>
<link href="../css/style.css" rel="stylesheet">
</head>
<body class="body-container">

  <h1>MSP430 Blinky LED for Professional Edition</h1>
	<p>
		<img class="standard-image", src="images/msp430.jpg" />
	<p>
		This tutorial is mainly contain three parts:
	<p>
		Installing the YAKINDU Statechart Tool as a Plugin to Texas Instruments Code Composer Studio
	<p>
		Adding state machines to the project
	<p>
		Creating the Blinky example with the Professional and Community Edition
	<p>
		The whole tutorial is a step by step tutorial and should give guidance till you can upload the project.
	</p>
	
  <h1> Installing the YAKINDU Statechart Tool as a Plugin to Texas Instruments Code Composer Studio </h1>
	<p>
		Firstly you need to install TIs Code Composer Studio, which you can find here: 
	<p>
		<a href=http://www.ti.com/tool/CCSTUDIO> Click for download </a>
	<p>
		Ensure you have at least chosen the MSP430 ultra-low power MCUs.
	<p>
		Open your CCS after installation. You can choose a test example of TI to ensure that you are connected to the launchpad and that you can compile and upload Code. 
		After this little test, you can install the plugin. Therefore, open the <i>Help</i> tab and click on <i>Install New Software...</i>
	<p>
		<img class="standard-image" src="images/installNewSoftware.png" />
	<p>
		There you can install Yakindu. You need two update sites for this. 
	<p>
		Firstly, the Eclipse Neon, which is used by TI, needs an update site for adding some Xtext plugins. 
		You don’t need to install anything. Yakindu just needs some parts of Xtext and must know the download site. 
		Click on Add and add  <a href=http://download.eclipse.org/releases/neon/> Eclipse Neon </a> to your repository.
	<p>
		<img class="standard-image" src="images/AddNeon.png" />		
	<p>
		After this, you need to get a the download site of YAKINDU Statechart Tool. 
		Go to <a href=https://info.itemis.com/download-yakindu-statechart-tools> our download site </a> and complete a free regestration. 
		Then you will get different installation options. 
		Choose the black button with install from <i>update site</i>. 
	<p>
		<img class="standard-image" src="images/DownloadOptions.png" />
	<p>
		Once again, go over the tab and install a new software. 
		There you add the url, which you copied from our site. 
		Choose at least the <i>YAKINDU Statechart Tools Professional Edition</i>. 
		You will get a trial version, which last for 30 days. 
		Don’t hesitate, our aren’t buying anything. If the time expired, you can still use all free Community Edition features.
	<p>
		<img class="standard-image" src="images/installSCT.png" />
	<p>
		Start the installation by clicking on <i>Next</i> and follow the instructions. 
		The installation wizard asks, if you really want to install the software. 
		Click on <i>Ok</i>. 
		After a successful installation CCS needs to be restartet. 
		Afterwards, the installation is finished.
	<p>
	
  <h1> Working with YAKINDU Statecharts Tool in CCS </h1>
  	<p>
		To use state machines proceed as normal and create a new CCS Project. 
		Open the <i>File</i> tab, open <i>New</i>, click on <i>Other</i> and search for <i>Code Composer Studio</i>. 
		There you can choose a <i>CCS Project</i>. 
		Define a project name, choose your microcontroller and create a empty project, which contains an empty main.c file. 
		I’ve used the MSP430G2553.
	<p>
	Now you can start working with state machines! 
	At this point it depends on you, which Edition you want to use - the Professional or Community Edition.
	<p>
	
  <h1> Working with YAKINDU Statecharts Tool Professional Edition </h1>
  	  	<p>
		Right click the project, open New and choose a <i>C Statechart Model</i>. 
		A Wizard will be opened in which you can select your project and name your project. 
		For example, call it “<i>blinkyStateMachine.sct</i>”.
	<p>
		<img class="standard-image" src="images/addStatechart.png" />
	<p>
		In the project folder the C Statechart Model will appear, after clicking on <i>Finish</i>. 
		Click on <i>Yes</i> if you were asked to change the perspective. 
		To import the header file, it is unfortunately necessary to additionally add the header file of the <i>msp430g2553.h</i> header file to your project. 
		Therefore, add a new file and call it “<i>msp430g2553.h</i>”. Open the original msp430g2553.h header file and simply copy it the created one. 
		Don’t forget to save it and once again, this is only needed to work with the header files in your state machine.
	<p>
		Now you can import the header file to your state machine. 
		Open the C Statechart Model once again write into the Textual Notifications “<i>import: msp430g2553.h<i>”, to get access. 
		This can also be done with code completion (<i>STRG + Space</i>). If the file was not found, try to refresh and clean your project. 
		Your project should look like this, without any errors markers:
	<p>
		<img class="standard-image" src="images/emptySCT.png" />
	<p>
		Finally, you can start creating your Code, like you know it from creating C-Code. 
		You can use mostly common C commands, access/manipulate all registers and ask for flags.
	<p>
  <h1> The simplest : a blink example created with Profession Edition </h1>
	<p>
		The goal is to create a project, in which the red LED gets initialized and toggles every 1 second. 
		Additionally the WDT is used for the state machines clock.
	<p>
		To do so, rename the “<i>StateA</i>”  to “<i>Initialization</i>” and add two new states named “<i>redOn</i>” and “<i>redOff</i>” to the main region. 
		Add the “<i>always</i>” and the two “<i>after 1 s</i>” transitions, as shown on the picture.
	<p>
		<img class="standard-image" src="images/stateSCT.png" />
	<p>
		Then you can easily copy the code here, or you enter it by your own. 
		Once again the code completion can be used.
	<p>
		<i>Initialization: entry / WDTCTL = WDT_MDLY_32; IE1 |= WDTIE; P1DIR |= BIT0</i>
	<p>
		<i>redOn: entry / P1OUT |= BIT0 </i>
	<p>
		<i>redOff: entry / P1OUT &= ~BIT0 </i>
	<p>
		Now the C Statechart Model is finished and should look like on this picture. After a rebuild a no error markers should appear.
	<p>
		<img class="standard-image" src="images/proSCT.png" />
	<p>
  <h1> Generate the C-Code </h1>
	<p> 
		Now it is time to generate the C-Code. Therefore, a generator must be added. 
		Right click the project once again and open <i>New</i> and click on <i>Code Generator Model</i>. 
		Choose a name for the sgen file. It’s a good choice to stay with the state machine name. 
		Call it "<i>blinkyStateMachine.sgen</i>" for example and click on Next. Choose the desired state machine by clicking on the checkbox. 
		Ensure that you have chosen the <i>YAKINDU SCT C Code Generator</i> and click on <i>Finish</i>.
	<p>
		<img class="standard-image" src="images/sgen.png" />
	<p>
		Build the project. The foldes src and src-gen should appear in your project.
		They include the generated C-Code, which will be automatically get updated, by editing and saving the Statechart. 
	<p>
		Because of the time dependent events two files must be added:
	<p>
		<i>sc_timer_service.c </i>
	<p>
		<i>sc_timer_service.h </i>
	<p>
		You can get them from Github. Just click on this <a href=https://github.com/Yakindu/examples/tree/master/basic_finite_state_machine_for_arduino/scutil> link </a>. 
		They were already added to the project.
	<p>
		Your project folder now should look like this:
	<p>
		<img class="standard-image" src="images/projectView.png" />
	<p>
	
  <h1> Change Compiler to C99 </h1>
	<p>
		Now you need to set the compiler. Therefore, right click your Project and open the <i>Properties view</i>. 
		Then go to <i>Build -> Advanced Options -> Language Options</i> and choose <i>Compile program in ANSI C99 mode. (--c99)</i> as the <i>C Dialect</i>.
	<p>
		<img class="standard-image" src="images/c99.png" />
	<p>
	
  <h1> Calling the State Machine in your main.c </h1>
	<p>
		Finally the state machine can be called in your main function. 
		Firstly you have to include the state machine and the timer service. 
		Then the state machine and timers must be defined. Afterwards the required functions must be declared. 
		The main function contains two parts. The initialization and enter function of the state machine and the initialization of the timer. 
		The second part is an endless loop - the while(1) loop. 
		Within this loop the run cycle function of the state machine gets executed. 
		Afterwards the MSP430 will be set into the Low Power Mode 0 and the General Interrupt Enable bit gets set. 
		Now the microcontroller is sleeping and waits for an interrupt. After the interrupt of the WDT, the timer will proceed. 
		This means that every timer gets updated and the elapsed time gets incremented by 32 - the time in milliseconds, which is proceed after every interrupt of the WDT. 
	<p>
		The <i>main.c</i> file is added to the example.
	<p>
	
  <h1> That’s it - Now you can build and upload it to your MSP430! </h1>
	<p>
		Feel free to implement your own projects. Of course you can freely choose your microcontroller or launchpad of TI. 
		You can also try to rebuild old projects and implement them with YAKINDU Statecharts Tool!
	<p>
	
  <h1> System and Version Information </h1>
	<p>
		System: Windows 10
	<p>
		YAKINDU Statechart Tool Version: 2.9.3
	<p>
		Code Composer Version: 7.0.0.00043
	<p>
		<i>Note: The MSP430G2 Launchpad is not supported by any Version of Linux.</i>

</body>
</html>
